from PIL import Image
import matplotlib.pyplot as plt
import numpy as np
from svg.path import parse_path 
from scipy import optimize
import sys


curve_point_total = 10


Sarajevo_image    = 'Sarajevo.png'
Sarajevo_text_path = """m 8.6482752,8.1125149 c 0,0 15.9452578,11.0806021 22.1612048,19.1883601 6.215948,8.107758 11.891379,15.674999 13.51293,25.13405 1.621552,9.459051 -0.270258,15.674999 3.783621,21.890947 4.053879,6.215948 4.837493,6.884804 10.810344,10.269827 8.309566,4.709321 10.886938,3.414229 16.387411,3.529756 7.672786,0.161151 8.788408,0.528633 14.714347,3.562543 7.097138,3.633531 11.328837,7.231406 17.274527,9.393472 5.94569,2.16207 9.66175,5.743 18.37759,5.67543 8.31045,-0.67564 13.93627,0.72374 17.02629,6.75647 2.03373,3.97051 2.84591,6.42766 2.16207,11.35086 -0.90319,5.00897 -0.68568,7.07197 -9.72931,13.51293 -6.79926,4.84251 -9.18879,4.05388 -17.02629,7.8375 -7.8375,3.78362 -11.0806,5.13491 -11.0806,11.89138 0,6.75646 6.21594,12.16163 11.89137,17.29655 5.67543,5.13491 7.02673,8.10776 5.40518,12.16164 -1.62156,4.05387 -6.75647,6.4862 -12.16164,9.7293 -5.40517,3.24311 -14.593965,7.8375 -22.161206,10.54009 -7.567241,2.70259 -20.269395,2.97284 -24.863791,11.62112 -4.594397,8.64828 -3.355463,13.96702 0.743211,17.36411 7.499676,6.21595 15.945257,-0.81077 24.323274,-4.86465 8.378016,-4.05388 15.539872,-2.83771 21.417992,2.90528 6.16779,6.02601 18.9181,50.2681 20.80991,56.21379 1.89181,5.94569 12.70216,37.02543 10.54009,42.70086 -2.16207,5.67543 -3.78362,11.89138 -12.16164,10.26982 -8.37801,-1.62155 -18.64784,-11.89137 -21.62069,-15.94525 -2.97284,-4.05388 -36.755165,-52.70043 -36.755165,-52.70043"""
Sarajevo_text_path_reverse = """m 72.429305,275.39827 c 0,0 33.782325,48.64655 36.755165,52.70043 2.97285,4.05388 13.24268,14.3237 21.62069,15.94525 8.37802,1.62156 9.99957,-4.59439 12.16164,-10.26982 2.16207,-5.67543 -8.64828,-36.75517 -10.54009,-42.70086 -1.89181,-5.94569 -14.64212,-50.18778 -20.80991,-56.21379 -5.87812,-5.74299 -13.039976,-6.95916 -21.417992,-2.90528 -8.378017,4.05388 -16.823598,11.0806 -24.323274,4.86465 -4.098674,-3.39709 -5.337608,-8.71583 -0.743211,-17.36411 4.594396,-8.64828 17.29655,-8.91853 24.863791,-11.62112 7.567241,-2.70259 16.756036,-7.29698 22.161206,-10.54009 5.40517,-3.2431 10.54008,-5.67543 12.16164,-9.7293 1.62155,-4.05388 0.27025,-7.02673 -5.40518,-12.16164 -5.67543,-5.13492 -11.89137,-10.54009 -11.89137,-17.29655 0,-6.75647 3.2431,-8.10776 11.0806,-11.89138 7.8375,-3.78362 10.22703,-2.99499 17.02629,-7.8375 9.04363,-6.44096 8.82612,-8.50396 9.72931,-13.51293 0.68384,-4.9232 -0.12834,-7.38035 -2.16207,-11.35086 -3.09002,-6.03273 -8.71584,-7.43211 -17.02629,-6.75647 -8.71584,0.0676 -12.4319,-3.51336 -18.37759,-5.67543 C 101.34697,98.919404 97.115271,95.321529 90.018133,91.687998 84.092194,88.654088 82.976572,88.286606 75.303786,88.125455 69.803313,88.009928 67.225941,89.30502 58.916375,84.595699 52.943524,81.210676 52.15991,80.54182 48.106031,74.325872 44.052152,68.109924 45.943962,61.893976 44.32241,52.434925 42.700859,42.975874 37.025428,35.408633 30.80948,27.300875 24.593533,19.193117 8.6482752,8.1125149 8.6482752,8.1125149"""
Sarajevo_length = 1200


Calgary_image    = 'Calgary.png'
Calgary_text_path = """m 238.53814,16.197033 c 0,0 -48.00212,37.400424 -63.90467,47.413136 -15.90254,10.012712 -18.84745,10.896186 -28.56567,11.779661 -9.71822,0.883474 -22.67585,3.239407 -28.27119,14.135593 -5.59534,10.896187 -13.54661,30.332627 -27.682203,36.811437 -14.135593,6.47882 -25.620763,12.36865 -25.620763,12.36865 0,0 -22.970339,9.12924 -15.019068,20.6144 7.951272,11.48517 7.65678,11.19068 25.620763,19.73094 17.963983,8.54025 22.086865,7.65678 29.743641,23.55932 7.65678,15.90254 12.07416,23.26483 20.31992,25.32627 8.24576,2.06144 9.71822,1.47246 14.72457,0.58898 5.00636,-0.88347 20.61441,-6.47881 23.85382,-2.65042 3.23941,3.82839 4.71186,15.60805 2.06144,20.31991 -2.65042,4.71187 -4.71187,8.83475 -16.49153,15.90255 -11.77966,7.06779 -20.31991,14.13559 -20.02542,30.92161 0.29449,16.78601 7.0678,63.61017 15.90254,78.62923 8.83475,15.01907 10.89619,19.73094 20.31992,20.02543 9.42373,0.29449 17.66949,-12.66314 17.375,-20.02543 -0.29449,-7.36228 -1.47246,-18.55296 -10.01271,-19.14194 -8.54026,-0.58899 -12.36865,-2.06145 -20.61441,3.53389 -8.24576,5.59534 -25.62076,17.375 -35.04449,20.61441 -9.42373,3.23941 -24.737291,12.07415 -33.277545,16.19703 -8.540254,4.12289 -25.620763,12.95763 -32.983051,15.01907 -7.362288,2.06144 -14.135593,5.88983 -17.963983,13.54661 -3.82839,7.65678 -5.006356,11.48517 -2.944915,21.20339 3.533898,12.07416 5.88983,30.03814 -1.472458,43.58475 -7.362288,13.54661 -12.368644,19.43644 -12.957627,33.27754 -0.588983,13.8411 -1.177966,26.20975 3.239407,27.09322 4.417373,0.88348 10.307203,0.88348 17.080508,-2.65042 6.773305,-3.5339 26.504237,-22.97034 30.627119,-26.20975 4.122881,-3.23941 40.345335,-39.46186 41.523305,-40.93432 1.17797,-1.47246 35.63347,-36.51695 42.70127,-41.22881 7.0678,-4.71187 42.11229,-32.09958 44.46822,-33.86653 2.35593,-1.76695 3.23941,-3.82839 3.23941,-3.82839"""
Calgary_text_path_reverse = """m 198.48729,397.85805 c 0,0 -0.88348,2.06144 -3.23941,3.82839 -2.35593,1.76695 -37.40042,29.15466 -44.46822,33.86653 -7.0678,4.71186 -41.5233,39.75635 -42.70127,41.22881 -1.17797,1.47246 -37.400424,37.69491 -41.523305,40.93432 -4.122882,3.23941 -23.853814,22.67585 -30.627119,26.20975 -6.773305,3.5339 -12.663135,3.5339 -17.080508,2.65042 -4.417373,-0.88347 -3.82839,-13.25212 -3.239407,-27.09322 0.588983,-13.8411 5.595339,-19.73093 12.957627,-33.27754 7.362288,-13.54661 5.006356,-31.51059 1.472458,-43.58475 -2.061441,-9.71822 -0.883475,-13.54661 2.944915,-21.20339 3.82839,-7.65678 10.601695,-11.48517 17.963983,-13.54661 7.362288,-2.06144 24.442797,-10.89618 32.983051,-15.01907 8.540254,-4.12288 23.853815,-12.95762 33.277545,-16.19703 9.42373,-3.23941 26.79873,-15.01907 35.04449,-20.61441 8.24576,-5.59534 12.07415,-4.12288 20.61441,-3.53389 8.54025,0.58898 9.71822,11.77966 10.01271,19.14194 0.29449,7.36229 -7.95127,20.31992 -17.375,20.02543 -9.42373,-0.29449 -11.48517,-5.00636 -20.31992,-20.02543 -8.83474,-15.01906 -15.60805,-61.84322 -15.90254,-78.62923 -0.29449,-16.78602 8.24576,-23.85382 20.02542,-30.92161 11.77966,-7.0678 13.84111,-11.19068 16.49153,-15.90255 2.65042,-4.71186 1.17797,-16.49152 -2.06144,-20.31991 -3.23941,-3.82839 -18.84746,1.76695 -23.85382,2.65042 -5.00635,0.88348 -6.47881,1.47246 -14.72457,-0.58898 -8.24576,-2.06144 -12.66314,-9.42373 -20.31992,-25.32627 -7.656776,-15.90254 -11.779658,-15.01907 -29.743641,-23.55932 -17.963983,-8.54026 -17.669491,-8.24577 -25.620763,-19.73094 -7.951271,-11.48516 15.019068,-20.6144 15.019068,-20.6144 0,0 11.48517,-5.88983 25.620763,-12.36865 14.135593,-6.47881 22.086863,-25.91525 27.682203,-36.811437 5.59534,-10.896186 18.55297,-13.252119 28.27119,-14.135593 9.71822,-0.883475 12.66313,-1.766949 28.56567,-11.779661 15.90255,-10.012712 63.90467,-47.413136 63.90467,-47.413136"""
Calgary_length = 1250


Lillehammer_image    = 'Lillehammer.png'
Lillehammer_text_path = """m 34.657221,16.126731 c 0,0 40.299094,44.329003 68.911449,57.224713 28.61236,12.895711 57.62771,18.537584 66.8965,33.448246 9.26879,14.91067 10.07477,14.50768 7.65683,22.97049 -2.41795,8.46281 -26.59741,22.56749 -41.91106,30.62731 -15.31366,8.05982 -19.74656,14.91066 -8.05982,29.01535 11.68674,14.10468 45.94097,45.94096 48.7619,47.55293 2.82094,1.61196 5.64188,6.85084 27.80638,7.65682 22.1645,0.80599 44.73199,2.01496 53.59779,11.28375 8.8658,9.26879 16.11964,20.55254 9.2688,27.80638 -6.85085,7.25383 -10.07478,15.71664 -32.64227,9.67178 -22.56749,-6.04487 -47.14994,-16.11964 -47.14994,-16.11964 0,0 -3.22393,-3.22393 -31.43329,2.41795 -28.20937,5.64187 -26.59741,10.47776 -66.49351,-2.41795 -39.896103,-12.89571 -70.120424,-20.95553 -75.359306,-8.46281 -5.2388823,12.49272 -2.820937,23.37348 7.656828,35.06021 10.477764,11.68674 33.851239,22.1645 61.657614,34.65722 27.806374,12.49272 36.672174,21.76151 29.821334,32.23928 -6.85085,10.47776 -21.761515,14.91066 -41.105081,10.47776 -19.343565,-4.4329 -34.65722,-6.44785 -43.523021,4.02991 -8.865801,10.47777 -11.283747,12.89571 3.626918,34.25423 14.910665,21.35852 35.866194,34.65722 33.045257,66.8965 -2.820936,32.23927 -2.820936,37.07517 2.820937,40.70208 5.641873,3.62692 28.612357,-2.01495 39.09012,-15.71664 10.47777,-13.70169 12.49272,-24.58245 10.47777,-35.8662 C 116.06139,464.25266 97.120817,432.81936 82.613143,419.52066 68.105469,406.22196 59.642659,395.7442 41.508067,373.5797 23.373475,351.41519 12.492719,335.29556 12.492719,335.29556"""
Lillehammer_text_path_reverse = """m 12.492719,335.29556 c 0,0 10.880756,16.11963 29.015348,38.28414 18.134592,22.1645 26.597402,32.64226 41.105076,45.94096 14.507674,13.2987 33.448247,44.732 35.463207,56.01574 2.01495,11.28375 0,22.16451 -10.47777,35.8662 -10.477763,13.70169 -33.448247,19.34356 -39.09012,15.71664 -5.641873,-3.62691 -5.641873,-8.46281 -2.820937,-40.70208 2.820937,-32.23928 -18.134592,-45.53798 -33.045257,-66.8965 -14.910665,-21.35852 -12.492719,-23.77646 -3.626918,-34.25423 8.865801,-10.47776 24.179456,-8.46281 43.523021,-4.02991 19.343566,4.4329 34.254231,0 41.105081,-10.47776 6.85084,-10.47777 -2.01496,-19.74656 -29.821334,-32.23928 C 56.015741,326.02676 32.642266,315.549 22.164502,303.86226 11.686737,292.17553 9.2687917,281.29477 14.507674,268.80205 c 5.238882,-12.49272 35.463203,-4.4329 75.359306,8.46281 39.8961,12.89571 38.28414,8.05982 66.49351,2.41795 28.20936,-5.64188 31.43329,-2.41795 31.43329,-2.41795 0,0 24.58245,10.07477 47.14994,16.11964 22.56749,6.04486 25.79142,-2.41795 32.64227,-9.67178 6.85084,-7.25384 -0.403,-18.53759 -9.2688,-27.80638 -8.8658,-9.26879 -31.43329,-10.47776 -53.59779,-11.28375 -22.1645,-0.80598 -24.98544,-6.04486 -27.80638,-7.65682 -2.82093,-1.61197 -37.07516,-33.44825 -48.7619,-47.55293 -11.68674,-14.10469 -7.25384,-20.95553 8.05982,-29.01535 15.31365,-8.05982 39.49311,-22.1645 41.91106,-30.62731 2.41794,-8.46281 1.61196,-8.05982 -7.65683,-22.97049 C 161.19638,91.889028 132.18103,86.247155 103.56867,73.351444 74.956315,60.455734 34.657221,16.126731 34.657221,16.126731"""
Lillehammer_length = 1350


Oberhof_image    = 'Oberhof.png'
Oberhof_text_path = """m 106.36864,27.208285 c 0,0 -3.65389,2.029936 -1.21797,10.961654 2.43593,8.931717 8.52573,19.081396 5.27784,25.57719 -3.2479,6.495795 -17.051464,19.487384 -17.457451,24.35923 -0.405987,4.871846 -4.871846,7.713756 17.051461,18.269421 21.92331,10.55567 40.19273,17.86344 43.03464,26.79515 2.84191,8.93172 -0.81198,12.17962 -17.45745,24.76522 -16.64547,12.5856 -17.86343,18.26942 -9.74369,21.51732 8.11974,3.2479 27.20114,5.27783 31.667,19.48738 4.46586,14.20955 0.81197,19.89337 -9.74369,22.73528 -10.55567,2.84191 -54.808271,8.11975 -54.808271,8.11975 0,0 -19.081396,5.27783 -19.487384,19.89337 -0.405987,14.61553 4.059872,22.73528 16.239487,23.54725 12.179618,0.81198 33.290948,1.21796 45.470558,17.05146 12.17962,15.8335 14.61554,16.23949 31.667,17.86344 17.05146,1.62395 29.23108,14.61554 25.98318,21.51732 -3.2479,6.90178 -0.40599,13.39757 -22.32929,17.05146 -21.92331,3.65388 -36.53885,6.90178 -39.38076,10.14968 -2.84191,3.24789 -12.17961,19.08139 0,24.76521 12.17962,5.68382 53.99629,15.02153 37.35082,36.13286 -16.64547,21.11133 -57.24419,54.40228 -57.24419,54.40228 0,0 -27.201139,20.29936 -26.795151,30.85502 0.405987,10.55567 4.465858,19.0814 12.179614,20.29936 7.713757,1.21796 21.923307,-6.08981 18.675407,-17.86343 -3.24789,-11.77363 -12.17961,-31.667 -22.329291,-41.41069 -10.149679,-9.7437 -37.350819,-41.81668 -37.350819,-41.81668 0,0 -19.89337,-24.35923 -25.983178,-33.69694 -6.089807,-9.3377 -17.05146,-29.63706 -14.20955,-37.7568 2.84191,-8.11974 4.059872,-9.74369 17.457448,-14.61554 13.397576,-4.87184 52.372343,-10.96165 52.372343,-10.96165"""
Oberhof_text_path_reverse = """m 85.257303,325.20286 c 0,0 -38.974767,6.08981 -52.372343,10.96165 -13.397576,4.87185 -14.615538,6.4958 -17.457448,14.61554 -2.84191,8.11974 8.119743,28.4191 14.20955,37.7568 6.089808,9.33771 25.983178,33.69694 25.983178,33.69694 0,0 27.20114,32.07298 37.350819,41.81668 10.149681,9.74369 19.081401,29.63706 22.329291,41.41069 3.2479,11.77362 -10.96165,19.08139 -18.675407,17.86343 -7.713756,-1.21796 -11.773627,-9.74369 -12.179614,-20.29936 -0.405988,-10.55566 26.795151,-30.85502 26.795151,-30.85502 0,0 40.59872,-33.29095 57.24419,-54.40228 16.64547,-21.11133 -25.1712,-30.44904 -37.35082,-36.13286 -12.17961,-5.68382 -2.84191,-21.51732 0,-24.76521 2.84191,-3.2479 17.45745,-6.4958 39.38076,-10.14968 21.9233,-3.65389 19.08139,-10.14968 22.32929,-17.05146 3.2479,-6.90178 -8.93172,-19.89337 -25.98318,-21.51732 -17.05146,-1.62395 -19.48738,-2.02994 -31.667,-17.86344 -12.17961,-15.8335 -33.29094,-16.23948 -45.470558,-17.05146 -12.179615,-0.81197 -16.645474,-8.93172 -16.239487,-23.54725 0.405988,-14.61554 19.487384,-19.89337 19.487384,-19.89337 0,0 44.252601,-5.27784 54.808271,-8.11975 10.55566,-2.84191 14.20955,-8.52573 9.74369,-22.73528 -4.46586,-14.20955 -23.54726,-16.23948 -31.667,-19.48738 -8.11974,-3.2479 -6.90178,-8.93172 9.74369,-21.51732 16.64547,-12.5856 20.29936,-15.8335 17.45745,-24.76522 -2.84191,-8.93171 -21.11133,-16.23948 -43.03464,-26.79515 C 88.099213,95.820115 92.565072,92.978205 92.971059,88.106359 c 0.405987,-4.871846 14.209551,-17.863435 17.457451,-24.35923 3.24789,-6.495794 -2.84191,-16.645473 -5.27784,-25.57719 -2.43592,-8.931718 1.21797,-10.961654 1.21797,-10.961654"""
Oberhof_length = 1350


Whistler_image    = 'Whistler.png'
Whistler_text_path = """m 60.26342,352.57207 c 0,0 -2.174454,40.07206 -2.795726,42.24652 -0.621272,2.17445 -0.931909,30.44234 -0.931909,30.44234 0,0 -1.863817,111.20776 -0.931908,130.15656 0.931908,18.94881 4.348906,18.94881 16.463718,26.71472 12.114811,7.7659 25.16153,-2.48509 31.374255,-6.21273 6.21272,-3.72763 7.14463,-11.49354 9.62972,-29.51043 2.48509,-18.0169 -0.62127,-20.50199 -4.03827,-23.60835 -3.417,-3.10637 -24.229622,-18.0169 -29.510437,-31.99553 -5.280815,-13.97863 4.348906,-39.4508 5.280815,-47.2167 0.931909,-7.76591 0,-7.14463 -4.348907,-23.29771 -4.348906,-16.15309 2.48509,-24.54026 17.395627,-45.35289 14.910532,-20.81262 10.872262,-27.64662 5.280812,-37.27634 -5.591448,-9.62972 -31.374252,-15.53181 -35.101886,-18.0169 -3.727634,-2.48509 -2.485089,-2.48509 -6.833996,-13.35735 -4.348906,-10.87227 -2.795726,-31.99553 0.310636,-41.00398 3.106362,-9.00845 11.804175,-15.22117 32.6168,-20.81262 20.812626,-5.59146 28.267896,-9.94036 34.169976,-17.39563 5.90209,-7.45527 0,-15.53181 -6.52336,-20.19135 -6.52336,-4.65955 -22.987074,1.86381 -39.140155,4.03827 -16.153082,2.17445 -20.191352,-7.14463 -22.055169,-14.28927 -1.863817,-7.14463 7.144632,-17.25944 10.250994,-20.05517 3.106362,-2.79572 28.578529,-11.94035 34.79125,-13.1829 6.21273,-1.24254 17.08499,-7.7659 22.05517,-11.1829 4.97018,-3.417 3.10636,-9.31909 -2.17445,-13.66799 -5.28082,-4.34891 -21.74453,0.31063 -25.16153,1.24254 -3.417001,0.93191 -33.548711,12.11481 -43.799705,8.69781 -10.250994,-3.41699 -15.221173,-8.07654 -17.706262,-13.35735 -2.48509,-5.28082 -2.48509,-9.94036 -2.48509,-12.73608 0,-2.79573 1.242545,-7.45527 1.242545,-7.45527 0,0 2.795726,-4.34891 5.902088,-6.52336 3.106361,-2.17446 19.259443,-1.55318 19.259443,-1.55318 0,0 5.280815,-0.62128 9.940358,-6.834 4.659543,-6.212723 6.52336,-77.037773 6.52336,-77.037773"""
Whistler_text_path_reverse = """m 79.212227,22.987077 c 0,0 -1.863817,70.82505 -6.52336,77.037773 -4.659543,6.21272 -9.940358,6.834 -9.940358,6.834 0,0 -16.153082,-0.62128 -19.259443,1.55318 -3.106362,2.17445 -5.902088,6.52336 -5.902088,6.52336 0,0 -1.242545,4.65954 -1.242545,7.45527 0,2.79572 0,7.45526 2.48509,12.73608 2.485089,5.28081 7.455268,9.94036 17.706262,13.35735 10.250994,3.417 40.382704,-7.7659 43.799705,-8.69781 3.417,-0.93191 19.88071,-5.59145 25.16153,-1.24254 5.28081,4.3489 7.14463,10.25099 2.17445,13.66799 -4.97018,3.417 -15.84244,9.94036 -22.05517,11.1829 -6.212721,1.24255 -31.684888,10.38718 -34.79125,13.1829 -3.106362,2.79573 -12.114811,12.91054 -10.250994,20.05517 1.863817,7.14464 5.902087,16.46372 22.055169,14.28927 16.153081,-2.17446 32.616795,-8.69782 39.140155,-4.03827 6.52336,4.65954 12.42545,12.73608 6.52336,20.19135 -5.90208,7.45527 -13.35735,11.80417 -34.169976,17.39563 -20.812625,5.59145 -29.510438,11.80417 -32.6168,20.81262 -3.106362,9.00845 -4.659542,30.13171 -0.310636,41.00398 4.348907,10.87226 3.106362,10.87226 6.833996,13.35735 3.727634,2.48509 29.510438,8.38718 35.101886,18.0169 5.59145,9.62972 9.62972,16.46372 -5.280812,37.27634 -14.910537,20.81263 -21.744533,29.1998 -17.395627,45.35289 4.348907,16.15308 5.280816,15.5318 4.348907,23.29771 -0.931909,7.7659 -10.56163,33.23807 -5.280815,47.2167 5.280815,13.97863 26.093437,28.88916 29.510437,31.99553 3.417,3.10636 6.52336,5.59145 4.03827,23.60835 -2.48509,18.01689 -3.417,25.7828 -9.62972,29.51043 -6.212725,3.72764 -19.259444,13.97863 -31.374255,6.21273 -12.114812,-7.76591 -15.53181,-7.76591 -16.463718,-26.71472 -0.931909,-18.9488 0.931908,-130.15656 0.931908,-130.15656 0,0 0.310637,-28.26789 0.931909,-30.44234 0.621272,-2.17446 2.795726,-42.24652 2.795726,-42.24652"""
Whistler_length = 1400


Alternberg_image    = 'Alternberg.png'
Alternberg_text_path = """m 17.568783,19.773013 c 0,0 6.771302,2.562115 12.993579,7.686343 6.222277,5.124228 19.581873,17.385775 19.581873,17.385775 0,0 6.771301,5.124228 13.176587,9.516424 6.405285,4.392196 16.470734,14.091628 17.202767,23.059027 0.732032,8.9674 2.562114,23.425048 -2.379106,42.823908 -4.941221,19.39887 -10.614473,39.71277 -11.529514,51.42529 -0.915041,11.71252 -2.196098,14.82366 1.464065,18.30082 3.660163,3.47715 19.032848,-19.76488 25.987158,-26.71919 6.954308,-6.95431 18.483828,-18.66683 36.418628,-14.82366 17.93479,3.84317 33.58199,12.44455 40.81081,18.30081 7.22883,5.85626 22.69302,17.11126 29.83033,27.72574 7.13732,10.61447 15.92171,22.51 -0.91504,36.60163 -16.83675,14.09163 -30.37935,25.52964 -41.35984,28.36626 -10.98049,2.83663 -25.07212,9.33342 -31.75192,5.85626 -6.67979,-3.47715 -10.88898,-12.53605 -6.40528,-20.67992 4.4837,-8.14386 15.55569,-15.8302 24.43159,-12.35305 8.87589,3.47716 10.24845,9.33342 10.88898,15.92171 0.64053,6.5883 -1.46406,14.45765 -14.27463,30.47086 -12.81057,16.01321 -17.29427,19.76488 -22.51001,50.32724 -5.21573,30.56236 -7.32032,30.37936 -9.24191,41.54285 -1.92158,11.1635 12.53606,31.93493 15.00667,42.73241 2.47061,10.79748 10.88205,13.80027 -17.19912,30.68779 -28.081164,16.88752 -54.221238,36.68669 -58.750459,48.59207 -4.529221,11.90538 -5.95269,22.38729 0,28.98701 5.95269,6.59972 9.964286,8.92904 13.32885,9.05844 3.364564,0.12941 13.587662,-0.25881 17.85807,-14.10528 4.270408,-13.84648 8.670223,-36.10436 7.505566,-49.95084 -1.164657,-13.84647 -1.552876,-41.28061 -3.105751,-60.56215 -1.552876,-19.28154 -5.564472,-46.71568 -5.305659,-60.43275"""
Alternberg_text_path_reverse = """m 79.326067,345.51484 c -0.258813,13.71707 3.752783,41.15121 5.305659,60.43275 1.552875,19.28154 1.941094,46.71568 3.105751,60.56215 1.164657,13.84648 -3.235158,36.10436 -7.505566,49.95084 -4.270408,13.84647 -14.493506,14.23469 -17.85807,14.10528 -3.364564,-0.1294 -7.37616,-2.45872 -13.32885,-9.05844 -5.95269,-6.59972 -4.529221,-17.08163 0,-28.98701 4.529221,-11.90538 30.669295,-31.70455 58.750459,-48.59207 28.08117,-16.88752 19.66973,-19.89031 17.19912,-30.68779 -2.47061,-10.79748 -16.92825,-31.56891 -15.00667,-42.73241 1.92159,-11.16349 4.02618,-10.98049 9.24191,-41.54285 5.21574,-30.56236 9.69944,-34.31403 22.51001,-50.32724 12.81057,-16.01321 14.91516,-23.88256 14.27463,-30.47086 -0.64053,-6.58829 -2.01309,-12.44455 -10.88898,-15.92171 -8.8759,-3.47715 -19.94789,4.20919 -24.43159,12.35305 -4.4837,8.14387 -0.27451,17.20277 6.40528,20.67992 6.6798,3.47716 20.77143,-3.01963 31.75192,-5.85626 10.98049,-2.83662 24.52309,-14.27463 41.35984,-28.36626 16.83675,-14.09163 8.05236,-25.98716 0.91504,-36.60163 -7.13731,-10.61448 -22.6015,-21.86948 -29.83033,-27.72574 -7.22882,-5.85626 -22.87602,-14.45764 -40.81081,-18.30081 -17.9348,-3.84317 -29.46432,7.86935 -36.418628,14.82366 -6.95431,6.95431 -22.326995,30.19634 -25.987158,26.71919 -3.660163,-3.47716 -2.379106,-6.5883 -1.464065,-18.30082 0.915041,-11.71252 6.588293,-32.02642 11.529514,-51.42529 4.94122,-19.39886 3.111138,-33.856508 2.379106,-42.823908 C 79.791556,68.453183 69.726107,58.753751 63.320822,54.361555 56.915536,49.969359 50.144235,44.845131 50.144235,44.845131 c 0,0 -13.359596,-12.261547 -19.581873,-17.385775 -6.222277,-5.124228 -12.993579,-7.686343 -12.993579,-7.686343"""
Alternberg_length = 1350


Koenigssee_image    = 'Koenigssee.png'
Koenigssee_text_path = """m 50.076801,27.618114 c 0,0 11.836335,11.229343 9.711864,27.314618 -2.12447,16.085276 -9.104873,23.369174 -3.641949,31.56356 5.462924,8.194385 13.353814,13.960808 16.085276,17.906248 2.731462,3.94545 4.552436,13.96081 4.855932,20.33422 0.303496,6.37341 -2.427966,17.90625 -3.945445,21.85169 -1.517479,3.94545 -6.676907,21.24471 -7.587394,28.8321 -0.910487,7.58739 -0.910487,13.05032 1.517479,16.99576 2.427966,3.94545 7.283898,10.92585 7.283898,16.69227 0,5.76642 -3.945445,13.05032 -6.069915,17.29926 -2.124471,4.24894 -4.855932,8.49788 -3.338454,15.47828 1.517479,6.9804 6.676907,34.59852 8.194386,39.15096 1.517479,4.55243 1.820975,22.76218 -0.303496,30.34957 -2.12447,7.5874 -4.552436,31.26007 -6.676907,37.63348 -2.12447,6.37341 -6.373411,23.97616 -5.159428,28.83209 1.213983,4.85594 1.820975,10.92585 4.552437,16.38878 2.731462,5.46292 6.373411,10.31885 6.980402,17.29925 0.606992,6.98041 1.213983,11.83634 -2.731461,16.99577 -3.945445,5.15942 -7.283899,10.92584 -14.567797,7.89089 -7.283898,-3.03496 -14.567797,-13.35382 -16.085276,-20.63772 -1.517478,-7.28389 -2.427966,-17.29925 2.731462,-21.85169 5.159428,-4.55244 13.960805,-2.42797 16.995763,-1.82097 3.034958,0.60699 8.497881,6.9804 10.622352,9.71186 2.12447,2.73146 8.801377,22.76218 9.711864,35.509 l 2.124471,22.45869 c 0,0 0.303495,15.17479 4.552436,23.06568 4.248941,7.89089 16.995759,20.33421 18.513239,24.58316 1.51748,4.24894 0.91049,10.01536 -0.30349,18.20974 -1.21399,8.19439 -3.94545,14.5678 -1.51748,19.12023 2.42796,4.55244 6.6769,7.2839 11.83633,6.37342 5.15943,-0.91049 6.67691,-6.06992 7.5874,-10.31886 0.91048,-4.24894 3.64195,-13.05032 1.51748,-25.49365 -2.12447,-12.44332 -8.19439,-24.27966 -15.78178,-33.99152 -7.5874,-9.71186 -12.44333,-11.22934 -14.871296,-36.116 -2.427967,-24.88665 -3.945445,-44.91737 -7.89089,-56.14671 -3.945445,-11.22935 -5.462924,-14.87129 -5.462924,-14.87129"""
Koenigssee_text_path_reverse = """m 79.51589,374.21028 c 0,0 1.517479,3.64194 5.462924,14.87129 3.945445,11.22934 5.462923,31.26006 7.89089,56.14671 2.427966,24.88666 7.283896,26.40414 14.871296,36.116 7.58739,9.71186 13.65731,21.5482 15.78178,33.99152 2.12447,12.44333 -0.607,21.24471 -1.51748,25.49365 -0.91049,4.24894 -2.42797,9.40837 -7.5874,10.31886 -5.15943,0.91048 -9.40837,-1.82098 -11.83633,-6.37342 -2.42797,-4.55243 0.30349,-10.92584 1.51748,-19.12023 1.21398,-8.19438 1.82097,-13.9608 0.30349,-18.20974 -1.51748,-4.24895 -14.264298,-16.69227 -18.513239,-24.58316 -4.248941,-7.89089 -4.552436,-23.06568 -4.552436,-23.06568 l -2.124471,-22.45869 c -0.910487,-12.74682 -7.587394,-32.77754 -9.711864,-35.509 -2.124471,-2.73146 -7.587394,-9.10487 -10.622352,-9.71186 -3.034958,-0.607 -11.836335,-2.73147 -16.995763,1.82097 -5.159428,4.55244 -4.24894,14.5678 -2.731462,21.85169 1.517479,7.2839 8.801378,17.60276 16.085276,20.63772 7.283898,3.03495 10.622352,-2.73147 14.567797,-7.89089 3.945444,-5.15943 3.338453,-10.01536 2.731461,-16.99577 -0.606991,-6.9804 -4.24894,-11.83633 -6.980402,-17.29925 -2.731462,-5.46293 -3.338454,-11.53284 -4.552437,-16.38878 -1.213983,-4.85593 3.034958,-22.45868 5.159428,-28.83209 2.124471,-6.37341 4.552437,-30.04608 6.676907,-37.63348 2.124471,-7.58739 1.820975,-25.79714 0.303496,-30.34957 -1.517479,-4.55244 -6.676907,-32.17056 -8.194386,-39.15096 -1.517478,-6.9804 1.213983,-11.22934 3.338454,-15.47828 2.12447,-4.24894 6.069915,-11.53284 6.069915,-17.29926 0,-5.76642 -4.855932,-12.74682 -7.283898,-16.69227 -2.427966,-3.94544 -2.427966,-9.40837 -1.517479,-16.99576 0.910487,-7.58739 6.069915,-24.88665 7.587394,-28.8321 1.517479,-3.94544 4.248941,-15.47828 3.945445,-21.85169 -0.303496,-6.37341 -2.12447,-16.38877 -4.855932,-20.33422 C 69.50053,100.4571 61.60964,94.690677 56.146716,86.496292 50.683792,78.301906 57.664195,71.018008 59.788665,54.932732 61.913136,38.847457 50.076801,27.618114 50.076801,27.618114"""
Koenigssee_length = 1250


Winterberg_image    = 'Winterberg.png'
Winterberg_text_path = """m 34.067797,118.38559 c 0,0 15.898305,-14.19491 33.5,-16.75 17.601695,-2.555082 77.788133,-24.983048 77.788133,-24.983048 0,0 37.47458,-11.355933 47.97882,-23.279661 10.50423,-11.923729 20.72457,-26.118645 29.52542,-25.550848 8.80085,0.567797 21.29237,7.949153 20.72458,17.885593 -0.5678,9.936441 -9.65255,25.550848 -14.19492,28.957628 -4.54237,3.406779 -22.71186,11.355932 -30.09322,13.911016 -7.38136,2.555085 -23.27966,9.368645 -36.90678,14.76271 -13.62712,5.39407 -48.83051,26.40254 -54.50847,32.08051 -5.67797,5.67797 -22.144072,17.88559 -26.402546,26.68644 -4.258475,8.80085 -3.690678,12.49153 -0.283899,15.89831 3.40678,3.40678 7.665255,4.82627 28.389835,5.11017 20.72457,0.28389 56.49576,0.56779 73.52966,-7.94916 17.0339,-8.51695 21.86017,-18.73728 17.88559,-23.56356 -3.97458,-4.82627 -11.35593,-9.08474 -19.02119,-7.38135 -7.66525,1.70339 -15.6144,5.11017 -24.98305,17.88559 -9.36864,12.77543 -10.22034,16.75 -14.19491,34.0678 -3.97458,17.31779 -1.98729,22.42796 -21.57627,30.94491 -19.58899,8.51695 -36.622885,25.55085 -36.906783,34.9195 -0.283899,9.36864 -3.40678,14.76271 20.440673,16.1822 23.84746,1.41949 49.11441,-8.51695 64.72882,-5.39407 15.61441,3.12288 29.80932,11.35593 28.67373,25.55085 -1.1356,14.19491 -13.62712,33.5 -23.84746,50.81779 -10.22034,17.3178 -5.67797,29.24153 -4.54237,50.8178 1.13559,21.57627 2.55508,7.94915 -3.69068,38.04237 -6.24576,30.09322 -9.65254,40.02967 -3.97458,51.95339 5.67797,11.92373 14.47882,16.46611 27.82204,12.20763 13.34322,-4.25847 29.24152,-16.4661 30.94491,-32.36441 1.70339,-15.8983 5.39407,-78.07203 4.25848,-89.99576 -1.1356,-11.92373 -6.24577,-104.75847 -6.81356,-109.58474"""
Winterberg_text_path_reverse = """m 218.3178,270.27119 c 0.56779,4.82627 5.67796,97.66101 6.81356,109.58474 1.13559,11.92373 -2.55509,74.09746 -4.25848,89.99576 -1.70339,15.89831 -17.60169,28.10594 -30.94491,32.36441 -13.34322,4.25848 -22.14407,-0.2839 -27.82204,-12.20763 -5.67796,-11.92372 -2.27118,-21.86017 3.97458,-51.95339 6.24576,-30.09322 4.82627,-16.4661 3.69068,-38.04237 -1.1356,-21.57627 -5.67797,-33.5 4.54237,-50.8178 10.22034,-17.31779 22.71186,-36.62288 23.84746,-50.81779 1.13559,-14.19492 -13.05932,-22.42797 -28.67373,-25.55085 -15.61441,-3.12288 -40.88136,6.81356 -64.72882,5.39407 -23.847453,-1.41949 -20.724572,-6.81356 -20.440673,-16.1822 0.283898,-9.36865 17.317793,-26.40255 36.906783,-34.9195 19.58898,-8.51695 17.60169,-13.62712 21.57627,-30.94491 3.97457,-17.3178 4.82627,-21.29237 14.19491,-34.0678 9.36865,-12.77542 17.3178,-16.1822 24.98305,-17.88559 7.66526,-1.70339 15.04661,2.55508 19.02119,7.38135 3.97458,4.82628 -0.85169,15.04661 -17.88559,23.56356 -17.0339,8.51695 -52.80509,8.23305 -73.52966,7.94916 -20.72458,-0.2839 -24.983055,-1.70339 -28.389835,-5.11017 -3.406779,-3.40678 -3.974576,-7.09746 0.283899,-15.89831 4.258474,-8.80085 20.724576,-21.00847 26.402546,-26.68644 5.67796,-5.67797 40.88135,-26.68644 54.50847,-32.08051 13.62712,-5.394065 29.52542,-12.207625 36.90678,-14.76271 7.38136,-2.555084 25.55085,-10.504237 30.09322,-13.911016 4.54237,-3.40678 13.62712,-19.021187 14.19492,-28.957628 0.56779,-9.93644 -11.92373,-17.317796 -20.72458,-17.885593 -8.80085,-0.567797 -19.02119,13.627119 -29.52542,25.550848 -10.50424,11.923728 -47.97882,23.279661 -47.97882,23.279661 0,0 -60.186438,22.427966 -77.788133,24.983048 -17.601695,2.55509 -33.5,16.75 -33.5,16.75"""
Winterberg_length = 1300




class Track():
    def __init__(self,name,forward_text_path,reverse_text_path,length):
        self.name = name+'.png'
        self.forward_text_path = forward_text_path
        self.reverse_text_path = reverse_text_path
        self.length = length

        forward_parsed_path = parse_path(forward_text_path)
        reverse_parsed_path = parse_path(reverse_text_path)

        self.forward_line_x, self.forward_line_y = zip(*[(p.real,p.imag) for p in (forward_parsed_path.point(i/self.length) for i in range(0,self.length+1))])
        self.reverse_line_x, self.reverse_line_y = zip(*[(p.real,p.imag) for p in (reverse_parsed_path.point(i/self.length) for i in range(0,self.length+1))])

        self.track_image = Image.open(self.name).convert('P')
        self.x_lim = self.track_image.size[0]
        self.y_lim = self.track_image.size[1]

    def plot_image(self):
        track = ((np.asarray(self.track_image)/225.0)-1.0)*(-1.0)
        self.forward_line_y = tuple((np.asarray(self.forward_line_y)-self.y_lim)*(-1))
        f = plt.figure(figsize=(3,10))
        ax = f.add_subplot(121)
        ax2 = f.add_subplot(122)
        ax.imshow(track, cmap=plt.get_cmap('gray'), vmin=0, vmax=1)
        ax2.plot(self.forward_line_x,self.forward_line_y,'b-')
        ax2.set_xlim(0,self.x_lim)
        ax2.set_ylim(0,self.y_lim)
        plt.show()






class ComputeCurvature:
    def __init__(self):
        self.xc = 0  # X-coordinate of circle center
        self.yc = 0  # Y-coordinate of circle center
        self.r = 0   # Radius of the circle
        self.xx = np.array([])  # Data points
        self.yy = np.array([])  # Data points

    def calc_r(self, xc, yc):
        return np.sqrt((self.xx-xc)**2 + (self.yy-yc)**2)

    def f(self, c):
        ri = self.calc_r(*c)
        return ri - ri.mean()

    def df(self, c):
        xc, yc = c
        df_dc = np.empty((len(c), x.size))
        ri = self.calc_r(xc, yc)
        df_dc[0] = (xc - x)/ri                   # dR/dxc
        df_dc[1] = (yc - y)/ri                   # dR/dyc
        df_dc = df_dc - df_dc.mean(axis=1)[:, np.newaxis]
        return df_dc

    def fit(self, xx, yy):
        self.xx = xx
        self.yy = yy
        center_estimate = np.r_[np.mean(xx), np.mean(yy)]
        center = optimize.leastsq(self.f, center_estimate, Dfun=self.df, col_deriv=True)[0]
        self.xc, self.yc = center
        ri = self.calc_r(*center)
        self.r = ri.mean()
        # return 1/self.r  # Return the curvature
        return self.r  # Return the radius




def smooth(x,window_len=11,window='hanning'):
    if x.ndim != 1:
        raise ValueError("smooth only accepts 1 dimension arrays.")
    if x.size < window_len:
        raise ValueError("Input vector needs to be bigger than window size.")        
    if window_len<3:
        return x        
    if not window in ['flat', 'hanning', 'hamming', 'bartlett', 'blackman']:
        raise ValueError("Window is on of 'flat', 'hanning', 'hamming', 'bartlett', 'blackman'")    
    s=np.r_[x[window_len-1:0:-1],x,x[-1:-window_len:-1]]
    #print(len(s))
    if window == 'flat': #moving average
        w=np.ones(window_len,'d')
    else:
        w=eval('np.'+window+'(window_len)')    
    y=np.convolve(w/w.sum(),s,mode='valid')
    return y    








# track = Track('Sarajevo',Sarajevo_text_path,Sarajevo_text_path_reverse,Sarajevo_length)
# track = Track('Calgary',Calgary_text_path,Calgary_text_path_reverse,Calgary_length)
# track = Track('Lillehammer',Lillehammer_text_path,Lillehammer_text_path_reverse,Lillehammer_length)
# track = Track('Oberhof',Oberhof_text_path,Oberhof_text_path_reverse,Oberhof_length)
# track = Track('Whistler',Whistler_text_path,Whistler_text_path_reverse,Whistler_length)
# track = Track('Altenberg',Alternberg_text_path,Alternberg_text_path_reverse,Alternberg_length)
# track = Track('Koenigssee',Koenigssee_text_path,Koenigssee_text_path_reverse,Koenigssee_length)
track = Track('Winterberg',Winterberg_text_path,Winterberg_text_path_reverse,Winterberg_length)

# use this to plot the grayscale image and the track side by side
# track.plot_image()







line_x = list(track.forward_line_x)[::-1]
# fix y (it is upside down)
line_y = tuple((np.asarray(track.forward_line_y)-track.y_lim)*(-1))
line_y = list(line_y)[::-1]


radius_array = []
for n in range (0,track.length-curve_point_total,curve_point_total):

    x = np.asarray(line_x[n:n+curve_point_total])
    y = np.asarray(line_y[n:n+curve_point_total])

    comp_curv = ComputeCurvature()
    radius = comp_curv.fit(x, y)
    radius_array.append(radius)


    # # Plot  result
    # theta_fit = np.linspace(-np.pi, np.pi, 180)
    # x_fit = comp_curv.xc + comp_curv.r*np.cos(theta_fit)
    # y_fit = comp_curv.yc + comp_curv.r*np.sin(theta_fit)
    # fig = plt.figure()
    # ax = fig.add_subplot(111)
    # ax.plot(line_x,line_y,'b-')
    # ax.set_xlim(0,track.x_lim)
    # ax.set_ylim(0,track.y_lim)
    # ax.plot(x_fit, y_fit, 'k--', label='fit', lw=2)
    # ax.plot(x, y, 'ro', label='data', ms=8, mec='b', mew=1)
    # ax.set_xlabel('x')
    # ax.set_ylabel('y')
    # ax.set_aspect(aspect='equal')
    # ax.set_title('radius = {:.2f}'.format(radius))
    # plt.savefig(track.name+'_'+str(n).zfill(4)+'.png')


print('average radius ', np.mean(radius_array))
print('median radius ', np.median(radius_array))
print('sum radius ', np.sum(radius_array))
print('sum radius / track length', np.sum(radius_array)/track.length)
curvature = 1/np.asarray(radius_array)


# plt.subplot(2,1,1)
# # plt.plot(curvature)
# plt.plot(smooth(curvature,7,'hamming'))
# plt.subplot(2,1,2)
# plt.hist(np.log(radius_array), bins=50)
# plt.show()
